# Denoising Diffusion Probabilistic Models

Jonathan Ho, Ajay Jain, Pieter Abbeel

Paper: https://arxiv.org/abs/2006.11239

Website: https://hojonathanho.github.io/diffusion

![Samples generated by our model](resources/samples.png)

Experiments run on Google Cloud TPU v3-8.
Requires TensorFlow 1.15 and Python 3.5, and these dependencies for CPU instances (see `requirements.txt`):
```
pip3 install fire
pip3 install scipy
pip3 install pillow
pip3 install tensorflow-probability==0.8
pip3 install tensorflow-gan==0.0.0.dev0
pip3 install tensorflow-datasets==2.1.0
```

The training and evaluation scripts are in the `scripts/` subdirectory.
The commands to run training and evaluation are in comments at the top of the scripts.
Data is stored in GCS buckets. The scripts are written to assume that the bucket names are of the form `gs://mybucketprefix-us-central1`; i.e. some prefix followed by the region.
The prefix should be passed into the scripts using the `--bucket_name_prefix` flag.

Models and samples can be found at: https://www.dropbox.com/sh/pm6tn31da21yrx4/AABWKZnBzIROmDjGxpB6vn6Ja

## **Integration with ðŸ¤— Diffusers library in PyTorch**

If you are looking for a PyTorch version for DDPM, you can check out the [Diffusers library](https://huggingface.co/docs/diffusers/api/pipelines/ddpm).
You can install diffusers as follows:

```
pip install diffusers torch accelerate
```

And then try out the model with just a couple lines of code:

```python
from diffusers import DDPMPipeline, DDIMPipeline, PNDMPipeline

model_id = "google/ddpm-cifar10-32"

# load model and scheduler
ddpm = DDPMPipeline.from_pretrained(model_id)  # you can replace DDPMPipeline with DDIMPipeline or PNDMPipeline for faster inference

# run pipeline in inference (sample random noise and denoise)
image = ddpm().images[0]

# save image
image.save("ddpm_generated_image.png")
```

More DDPM models can be found directly [on the Hub](https://huggingface.co/models?library=diffusers&sort=downloads&search=ddpm)

To better understand DDPM, you can check out [this introductionary google colab](https://colab.research.google.com/github/huggingface/notebooks/blob/main/diffusers/diffusers_intro.ipynb)
To train your own DDPM from scratch, feel free to have a look at [unconditional_image_generation](https://github.com/huggingface/diffusers/tree/main/examples/unconditional_image_generation)

## Citation
If you find our work relevant to your research, please cite:
```
@article{ho2020denoising,
    title={Denoising Diffusion Probabilistic Models},
    author={Jonathan Ho and Ajay Jain and Pieter Abbeel},
    year={2020},
    journal={arXiv preprint arxiv:2006.11239}
}
```
